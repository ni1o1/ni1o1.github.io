import{u as T,r as a,j as t,T as j,R as f,C as h,a as _,A as B}from"./index-56561537.js";import{T as E,L as v}from"./LikeDislike-9ccf321c.js";import{S as w,L as y}from"./index-84df5ada.js";const{Title:F,Paragraph:P}=j,{Option:q}=w;function W(){const{t:l,i18n:x}=T(),[p,S]=a.useState([]),[g,R]=a.useState([]),[b,u]=a.useState([]),[k,z]=a.useState([]),[C,I]=a.useState({}),[D,m]=a.useState(!0),[M,A]=a.useState(new Map);a.useEffect(()=>{(async()=>{try{m(!0);const s=await(await fetch("/research/index.json")).json(),o=s.map((n,c)=>({...n,textlength:13,position:"left"}));R(o),u(o);const i=s.flatMap(n=>n.keywords).reduce((n,c)=>(n[c]=(n[c]||0)+1,n),{});I(i);const d=[...new Set(s.flatMap(n=>n.keywords))].sort((n,c)=>i[c]-i[n]);z(d)}catch(r){console.error("Failed to load research data:",r)}finally{m(!1)}})()},[]),a.useEffect(()=>{const e=g.map(s=>s.id);if(e.length===0)return;(async()=>{try{const s=new B.Query("Ratings");s.containedIn("itemId",e),s.limit(1e3);const o=await s.find(),i=new Map(o.map(d=>[d.get("itemId"),{likes:d.get("likes")||0,dislikes:d.get("dislikes")||0,objectId:d.id}]));A(i)}catch(s){console.error("Failed to batch fetch ratings:",s)}})()},[g]),a.useEffect(()=>{p.length>0?u(g.filter(e=>p.some(r=>e.keywords.includes(r)))):u(g)},[p]);const K=e=>{S(e)},L=e=>{const r=M.get(e.id)||{likes:0,dislikes:0,objectId:null},s=t.jsxs(h,{xs:24,sm:24,md:24,lg:e.textlength,style:{paddingRight:"10px"},children:[t.jsx("a",{href:e.src,target:"_blank",style:{textDecoration:"none",fontWeight:"bold",marginBottom:"4px",fontSize:"16px"},children:x.language==="zh"?e.title_zh:e.title_en}),t.jsx(P,{style:{textAlign:"justify",marginBottom:"8px",fontSize:"13px"},ellipsis:{rows:3,expandable:!0,symbol:l("更多")},children:x.language==="zh"?e.description:e.description_en}),t.jsxs("div",{children:[e.keywords&&e.keywords.map(i=>t.jsx(E,{color:"blue",style:{marginBottom:"4px",fontSize:"12px",padding:"0px 4px"},children:l(i)},i)),t.jsx(v,{itemId:e.id,initialLikes:r.likes,initialDislikes:r.dislikes,objectId:r.objectId})]})]}),o=t.jsx(h,{xs:24,sm:24,md:24,lg:24-e.textlength,children:t.jsx("img",{alt:x.language==="zh"?e.title_zh:e.title_en,src:e.imgpath,style:{objectFit:"cover",width:"100%",height:"180px",borderRadius:"4px"}})});return e.position==="right"?t.jsxs(f,{gutter:[20,20],align:"middle",children:[o,s]}):t.jsxs(f,{gutter:[20,20],align:"middle",children:[s,o]})};return t.jsxs(j,{style:{padding:"10px 20px"},children:[t.jsxs(f,{gutter:[16,16],align:"middle",style:{marginBottom:"15px"},children:[t.jsx(h,{xs:24,sm:24,md:8,lg:6,xl:5,children:t.jsx(F,{level:3,style:{margin:0,fontSize:"20px"},children:l("代表性成果")})}),t.jsx(h,{xs:24,sm:24,md:16,lg:18,xl:19,children:t.jsx(w,{mode:"multiple",placeholder:l("关键词筛选"),onChange:K,allowClear:!0,style:{width:"50%"},children:k.map(e=>t.jsxs(q,{value:e,children:[l(e)," ",t.jsxs("span",{style:{fontSize:"12px",color:"#999"},children:["(",C[e],l(" 篇"),")"]})]},e))})})]}),t.jsx(y,{grid:{gutter:24,xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},dataSource:b,loading:D,renderItem:e=>t.jsx(y.Item,{style:{padding:"0px 0"},children:t.jsx(_,{style:{width:"100%",marginBottom:"12px",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:L(e)})},e.id),pagination:{position:"both",pageSize:5,showSizeChanger:!1}})]})}export{W as default};
