import{e as h,aa as se,p as re,r,a7 as W,l as _,Q as ae,X as ce,a4 as U,U as ie,P as de,W as J,d as w,aw as q,aI as ue,J as ge,aJ as fe,aK as Ce,aL as be,aM as pe,j as $,aF as M,A}from"./index-f66defce.js";function V(e){if(e)return{closable:e.closable,closeIcon:e.closeIcon}}function D(e){const{closable:t,closeIcon:n}=e||{};return h.useMemo(()=>{if(!t&&(t===!1||n===!1||n===null))return!1;if(t===void 0&&n===void 0)return null;let o={closeIcon:typeof n!="boolean"&&n!==null?n:void 0};return t&&typeof t=="object"&&(o=Object.assign(Object.assign({},o),t)),o},[t,n])}function F(){const e={};for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return n.forEach(l=>{l&&Object.keys(l).forEach(a=>{l[a]!==void 0&&(e[a]=l[a])})}),e}const me={};function he(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:me;const o=D(e),l=D(t),a=typeof o!="boolean"?!!(o!=null&&o.disabled):!1,s=h.useMemo(()=>Object.assign({closeIcon:h.createElement(se,null)},n),[n]),u=h.useMemo(()=>o===!1?!1:o?F(s,l,o):l===!1?!1:l?F(s,l):s.closable?s:!1,[o,l,s]);return h.useMemo(()=>{if(u===!1)return[!1,null,a];const{closeIconRender:i}=s,{closeIcon:C}=u;let c=C;if(c!=null){i&&(c=i(C));const f=re(u,!0);Object.keys(f).length&&(c=h.isValidElement(c)?h.cloneElement(c,f):h.createElement("span",Object.assign({},f),c))}return[!0,c,a]},[u,s])}var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.9 490.3c3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-51.6-30.7-98.1-78.3-118.4a66.1 66.1 0 00-26.5-5.4H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h129.3l85.8 310.8C372.9 889 418.9 924 470.9 924c29.7 0 57.4-11.8 77.9-33.4 20.5-21.5 31-49.7 29.5-79.4l-6-122.9h239.9c12.1 0 23.9-3.2 34.3-9.3 40.4-23.5 65.5-66.1 65.5-111 0-28.3-9.3-55.5-26.1-77.7zM184 456V172h81v284h-81zm627.2 160.4H496.8l9.6 198.4c.6 11.9-4.7 23.1-14.6 30.5-6.1 4.5-13.6 6.8-21.1 6.7a44.28 44.28 0 01-42.2-32.3L329 459.2V172h415.4a56.85 56.85 0 0133.6 51.8c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-14 25.5 21.9 19a56.76 56.76 0 0119.6 43c0 19.1-11 37.5-28.8 48.4z"}}]},name:"dislike",theme:"outlined"};const ye=ve;var Se=function(t,n){return r.createElement(W,_({},t,{ref:n,icon:ye}))},Oe=r.forwardRef(Se);const xe=Oe;var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.9 533.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.4-65.5-111.1a67.67 67.67 0 00-34.3-9.3H572.4l6-122.9c1.4-29.7-9.1-57.9-29.5-79.4A106.62 106.62 0 00471 99.9c-52 0-98 35-111.8 85.1l-85.9 311H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h601.3c9.2 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7-.2-12.6-2-25.1-5.6-37.1zM184 852V568h81v284h-81zm636.4-353l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 22.4-13.2 42.6-33.6 51.8H329V564.8l99.5-360.5a44.1 44.1 0 0142.2-32.3c7.6 0 15.1 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.2 32.1-19.6 43z"}}]},name:"like",theme:"outlined"};const ke=$e;var Ie=function(t,n){return r.createElement(W,_({},t,{ref:n,icon:ke}))},je=r.forwardRef(Ie);const Ee=je,Te=e=>{const{paddingXXS:t,lineWidth:n,tagPaddingHorizontal:o,componentCls:l,calc:a}=e,s=a(o).sub(n).equal(),u=a(t).sub(n).equal();return{[l]:Object.assign(Object.assign({},ce(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:s,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${U(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${l}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${l}-close-icon`]:{marginInlineStart:u,fontSize:e.tagIconSize,color:e.colorIcon,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${l}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${l}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:s}}),[`${l}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},N=e=>{const{lineWidth:t,fontSizeIcon:n,calc:o}=e,l=e.fontSizeSM;return ie(e,{tagFontSize:l,tagLineHeight:U(o(e.lineHeightSM).mul(l).equal()),tagIconSize:o(n).sub(o(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},z=e=>({defaultBg:new de(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),X=ae("Tag",e=>{const t=N(e);return Te(t)},z);var we=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(n[o[l]]=e[o[l]]);return n};const Ne=r.forwardRef((e,t)=>{const{prefixCls:n,style:o,className:l,checked:a,onChange:s,onClick:u}=e,i=we(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:C,tag:c}=r.useContext(J),f=p=>{s==null||s(!a),u==null||u(p)},m=C("tag",n),[S,g,d]=X(m),v=w(m,`${m}-checkable`,{[`${m}-checkable-checked`]:a},c==null?void 0:c.className,l,g,d);return S(r.createElement("span",Object.assign({},i,{ref:t,style:Object.assign(Object.assign({},o),c==null?void 0:c.style),className:v,onClick:f})))}),ze=Ne,Pe=e=>ue(e,(t,n)=>{let{textColor:o,lightBorderColor:l,lightColor:a,darkColor:s}=n;return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:o,background:a,borderColor:l,"&-inverse":{color:e.colorTextLightSolid,background:s,borderColor:s},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),Re=q(["Tag","preset"],e=>{const t=N(e);return Pe(t)},z);function Be(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const I=(e,t,n)=>{const o=Be(n);return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:e[`color${n}`],background:e[`color${o}Bg`],borderColor:e[`color${o}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Le=q(["Tag","status"],e=>{const t=N(e);return[I(t,"success","Success"),I(t,"processing","Info"),I(t,"error","Error"),I(t,"warning","Warning")]},z);var He=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(n[o[l]]=e[o[l]]);return n};const Me=r.forwardRef((e,t)=>{const{prefixCls:n,className:o,rootClassName:l,style:a,children:s,icon:u,color:i,onClose:C,bordered:c=!0,visible:f}=e,m=He(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:S,direction:g,tag:d}=r.useContext(J),[v,p]=r.useState(!0),O=ge(m,["closeIcon","closable"]);r.useEffect(()=>{f!==void 0&&p(f)},[f]);const k=fe(i),P=Ce(i),j=k||P,Q=Object.assign(Object.assign({backgroundColor:i&&!j?i:void 0},d==null?void 0:d.style),a),b=S("tag",n),[G,Y,Z]=X(b),ee=w(b,d==null?void 0:d.className,{[`${b}-${i}`]:j,[`${b}-has-color`]:i&&!j,[`${b}-hidden`]:!v,[`${b}-rtl`]:g==="rtl",[`${b}-borderless`]:!c},o,l,Y,Z),R=x=>{x.stopPropagation(),C==null||C(x),!x.defaultPrevented&&p(!1)},[,oe]=he(V(e),V(d),{closable:!1,closeIconRender:x=>{const ne=r.createElement("span",{className:`${b}-close-icon`,onClick:R},x);return be(x,ne,y=>({onClick:H=>{var E;(E=y==null?void 0:y.onClick)===null||E===void 0||E.call(y,H),R(H)},className:w(y==null?void 0:y.className,`${b}-close-icon`)}))}}),te=typeof m.onClick=="function"||s&&s.type==="a",B=u||null,le=B?r.createElement(r.Fragment,null,B,s&&r.createElement("span",null,s)):s,L=r.createElement("span",Object.assign({},O,{ref:t,className:ee,style:Q}),le,oe,k&&r.createElement(Re,{key:"preset",prefixCls:b}),P&&r.createElement(Le,{key:"status",prefixCls:b}));return G(te?r.createElement(pe,{component:"Tag"},L):L)}),K=Me;K.CheckableTag=ze;const De=K,T="research_ratings",Ae=({itemId:e,initialLikes:t=0,initialDislikes:n=0,objectId:o})=>{const[l,a]=r.useState(t),[s,u]=r.useState(n),[i,C]=r.useState(null),[c,f]=r.useState(o);r.useEffect(()=>{a(t),u(n),f(o);const g=JSON.parse(localStorage.getItem(T)||"{}");g[e]&&C(g[e])},[t,n,o,e]);const m=g=>{const d=JSON.parse(localStorage.getItem(T)||"{}");d[e]=g,localStorage.setItem(T,JSON.stringify(d)),C(g)},S=async g=>{if(i===g)return;let d=g==="liked"?1:i==="liked"?-1:0,v=g==="disliked"?1:i==="disliked"?-1:0;if(a(l+d),u(s+v),m(g),c){const p=A.Object.createWithoutData("Ratings",c);p.increment("likes",d),p.increment("dislikes",v),p.save().catch(console.error)}else{const p=A.Object.extend("Ratings"),O=new p;O.set("itemId",e),O.set("likes",l+d),O.set("dislikes",s+v),O.save().then(k=>{f(k.id)}).catch(console.error)}};return $.jsxs("div",{className:"ratings-container",style:{display:"flex",alignItems:"center",gap:"10px"},children:[$.jsx(M,{type:"text",icon:$.jsx(Ee,{}),onClick:()=>S("liked"),disabled:i==="liked",style:{color:i==="liked"?"#1890ff":"rgba(0, 0, 0, 0.45)"},children:l}),$.jsx(M,{type:"text",icon:$.jsx(xe,{}),onClick:()=>S("disliked"),disabled:i==="disliked",style:{color:i==="disliked"?"#ff4d4f":"rgba(0, 0, 0, 0.45)"},children:s})]})},Fe=Ae;export{Fe as L,De as T};
