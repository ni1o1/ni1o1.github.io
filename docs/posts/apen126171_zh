## 论文发表 | Applied Energy | 时空特征编码深度学习方法用于屋顶光伏潜力评估

原文题目：Spatiotemporal Feature Encoded Deep Learning Method for Rooftop PV Potential Assessment

原文链接：[https://doi.org/10.1016/j.apenergy.2025.126171](https://doi.org/10.1016/j.apenergy.2025.126171)

## 摘要

屋顶光伏（PV）系统是提升城市可再生能源利用的有前景的解决方案。然而，复杂的城市形态引起的遮挡效应显著降低了屋顶表面的太阳辐照度，导致预测误差，阻碍了对屋顶光伏发电潜力的准确估计。传统的遮挡模拟方法计算成本高昂，凸显了在计算效率和评估精度之间取得微妙平衡的需求。在本研究中，我们引入了一种创新的深度学习框架，该框架有效地编码了多样化的时空数据源，以准确预测阴影投射并计算屋顶光伏潜力。具体来说，该框架利用基于物理学的地面真值，结合 U-Net 网络、三维（3D）建筑细节、太阳资源数据和气象参数，能够精确预测屋顶阴影模式的时间变化。这不仅提高了计算效率，而且确保了发电潜力预测的高精度。在深圳福田区进行的实验评估显示，仅遮挡效应就导致屋顶平均能量损失 5.32%。此外，与基于物理学的模型相比，我们的框架表现出卓越的性能，年发电潜力评估的平均绝对百分比误差（MAPE）为 2.85%，遮挡效应评估的平均交并比（mIoU）为 89.23%。此外，所提出的框架比传统的射线投射方法和优化的射线追踪方法分别快约 158 倍和 65 倍，凸显了其在大型城市能源评估中的强大适用性。我们的贡献包括开发了一种用于屋顶光伏潜力评估的新型深度学习框架，提高了城市分析的计算效率，并在各种城市环境中具有高精度的鲁棒泛化能力。

## Research Gap

现有城市屋顶光伏潜力评估方法在计算效率和评估精度之间难以平衡。传统基于物理模型（如射线投射、3D-GIS）的方法虽然能精确模拟复杂城市形态下的动态遮挡效应，但计算成本极高，难以应用于大规模城市范围；而简化方法虽快，却因忽略关键的遮挡因素而精度不足。尽管深度学习在屋顶特征提取方面已有应用，但尚未被用于动态遮挡效应的计算。因此，亟需一种能够高效、准确地预测城市屋顶动态阴影，并在此基础上进行大规模光伏潜力评估的新方法。

## 核心内容

本研究提出了一个基于深度学习的框架，用于高效准确地评估城市屋顶光伏潜力。

*   **框架概述与数据准备：** 研究构建了一个包含深度学习阴影预测模块和光伏潜力计算模块的整体框架。首先，将三维建筑数据、太阳高度角和方位角等时空信息转化为三通道栅格图像作为深度学习模型的输入。同时，利用基于三角原理的物理方法生成不同时刻屋顶阴影分布的栅格图像作为模型的训练标签（地面真值）。

![title](../posts/images/WX20250523-150707.png)

*   **深度学习模型设计与训练：** 采用基于 U-Net 架构（结合 FCN 解码头）的深度学习模型，输入是编码了三维建筑和太阳位置信息的多通道图像，输出是屋顶阴影、光照和地面区域的像素级分类结果。模型包含编码器（卷积、ReLU、BatchNorm、MaxPooling）和解码器（上采样、跳跃连接、卷积），通过交叉熵损失函数进行训练，并通过调整类别权重来应对阴影类别数据不平衡的问题。

![title](../posts/images/WX20250523-150738.png)

*   **光伏潜力计算模型：** 利用深度学习模型预测得到的屋顶阴影/光照区域信息，结合气象数据（直接辐射、散射辐射、全球水平辐射、温度、风速）和光伏系统参数（倾斜角、反射率等），使用 pvlib 库计算屋顶阵列平面（POA）接收的总辐照度，并进一步估算单位面积的光伏发电潜力。


*   **阴影与光照预测结果及时空验证：** 模型在深圳福田区对屋顶阴影和光照分布进行了预测。结果显示，阴影区域 IoU 为 72.8%，光照区域 IoU 为 95.31%，地面区域 IoU 为 100%。模型的时空预测结果与物理模型高度一致，尽管在中午阴影面积最小时阴影检测精度略有下降。
`图 4`，`图 6`

![title](../posts/images/WX20250523-150837.png)

![title](../posts/images/WX20250523-150847.png)


*   **光伏潜力评估结果与验证：** 将预测的阴影信息用于光伏潜力计算，并在福田区进行了验证。区域尺度的年发电总量预测与地面真值高度吻合（平均 MAPE 2.85%）。单栋建筑分析表明，遮挡是影响光伏潜力的关键因素，高遮挡建筑潜力显著降低。区域尺度的月度潜力分析显示出明显的季节性变化。

![title](../posts/images/WX20250523-150954.png)

![title](../posts/images/WX20250523-150941.png)


*   **福田区光伏潜力空间分析：** 对福田区整体的年屋顶光伏潜力空间分布进行了分析。结果显示潜力在 200-350 kWh/m² 之间变化，受建筑密度和高度差异影响显著。高遮挡区域潜力较低，平均遮挡导致约 5.32% 的能量损失。统计分布表明大部分屋顶潜力超过阈值，但部分建筑因遮挡严重潜力较低。

![title](../posts/images/WX20250523-151041.png)
![title](../posts/images/WX20250523-151030.png)

*   **计算效率分析：** 比较了深度学习框架与物理模型（Pybdshadow 和 Ray Tracing）的计算效率。深度学习框架在计算福田区全年阴影分布时仅需 1.34 小时，而 Pybdshadow 需要 213.21 小时，Ray Tracing 需要 87.60 小时，分别提速约 158 倍和 65 倍。深度学习方法随建筑数量增加的计算量增长率更低，且计算时间更稳定。

![title](../posts/images/WX20250523-151124.png)

## 论文总结

本研究提出了一种基于深度学习的创新框架，通过高精度预测屋顶阴影分布并结合气象数据，实现了城市尺度屋顶光伏潜力的高效准确评估。在深圳福田区的验证结果表明，该方法在阴影预测（阴影 IoU 72.8%）和光伏潜力评估（年潜力 MAPE < 3%）方面均表现出色。研究量化了城市形态对光伏潜力的影响，发现遮挡效应导致平均 5.32% 的能量损失，并揭示了建筑高度差异和密度是影响潜力分布的关键因素。最重要的是，该框架在计算效率上取得了显著突破，相较于传统物理模型实现了高达 158 倍的加速，使其能够高效处理大规模城市分析任务。

研究成果为城市规划者和政策制定者提供了强有力的工具，支持更精准的太阳能部署规划和政策制定，有助于推动城市可持续能源发展。尽管模型在复杂遮挡环境下的精度仍有提升空间，且未考虑结构可行性等实际限制，未来的研究将探索更先进的模型架构、更高分辨率数据和更全面的实际因素，以进一步提高模型的泛化能力和实用性，使其能直接应用于全球不同城市。
